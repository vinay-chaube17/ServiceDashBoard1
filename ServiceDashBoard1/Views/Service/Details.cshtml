
@* @model ServiceDashBoard1.Models.ServiceModel *@

@* <div class="container mt-4"> *@
@*     <h2 class="text-center mb-4">Complaint Details</h2> *@

@*     <div class="card shadow p-4"> *@
@*         <table class="table table-bordered"> *@
@*             <tbody> *@
@*                 <tr><th>Token:</th><td>@Model.TokenNumber</td></tr> *@
@*                 <tr><th>Machine:</th><td>@Model.MachineSerialNo</td></tr> *@
@*                 <tr><th>Company:</th><td>@Model.CompanyName</td></tr> *@
@*                 <tr><th>Email:</th><td>@Model.Email</td></tr> *@
@*                 <tr><th>Phone:</th><td>@Model.PhoneNo</td></tr> *@
@*                 <tr><th>Address:</th><td>@Model.Address</td></tr> *@
@*                 <tr><th>Contact Person:</th><td>@Model.ContactPerson</td></tr> *@
@*                 <tr><th>Description:</th><td>@Model.ComplaintDescription</td></tr> *@


@*                 <tr> *@
@*                     <th>Main Problem(s):</th> *@
@*                     <td><input type="text" class="form-control" value="@Model.MainProblemText" readonly /></td> *@
@*                 </tr> *@
@*                 <tr> *@
@*                     <th>Sub Problem(s):</th> *@
@*                     <td><input type="text" class="form-control" value="@Model.SubProblemText" readonly /></td> *@
@*                 </tr> *@

@*                 <tr><th>Current Status:</th><td><span class="badge bg-success text-white fw-bold fs-5 text-uppercase">@Model.Status</span></td></tr> *@
@*                 <tr> *@
@*                     <th>Image:</th> *@
@*                     <td class="text-center"> *@
@*                         @if (!string.IsNullOrEmpty(Model.ImageBase64)) *@
@*                         { *@
@*                             <img src="data:image/png;base64,@Model.ImageBase64" alt="Complaint Image" class="img-thumbnail" style="max-width: 200px;" /> *@
@*                         } *@
@*                         else *@
@*                         { *@
@*                             <span class="text-muted">No Image Available</span> *@
@*                         } *@
@*                     </td> *@
@*                 </tr> *@

@*             </tbody> *@
@*         </table> *@
@*     </div> *@

@*     <div class="mt-4"> *@
@*         <h3 class="fw-bold text-dark">Remark</h3> *@
@*         <form method="post" id="complaintForm"> *@
@*             <input type="hidden" asp-for="ComplaintId" /> *@
@*             <input type="hidden" id="selectedStatus" name="Status" value="@Model.Status" /> *@
@*             <input type="hidden" id="dynamicAction" name="actionName" value="" /> *@

@*             <div class="form-group"> *@
@*                 <textarea asp-for="Remark" class="form-control fw-bold text-dark" rows="4" placeholder="Enter your remark here..." required>@Model.Remark</textarea> *@
@*                 <span asp-validation-for="Remark" class="text-danger"></span> *@
@*             </div> *@

@*             @if (!string.IsNullOrWhiteSpace(Model.RemarkBy)) *@
@*             { *@
@*                 <div class="row"> *@
@*                     <div class="col-md-6"> *@
@*                         <div class="form-group"> *@
@*                             <label><strong>Remark By</strong></label> *@
@*                             <input type="text" class="form-control" value="@Model.RemarkBy" readonly /> *@
@*                         </div> *@
@*                     </div> *@
@*                 </div> *@
@*             } *@



@*             <div class="form-group mt-3" id="finalRemarkSection" style="display: none;"> *@
@*                 <label for="FinalRemark" class="fw-bold text-dark h3">FinalRemark</label> *@
@*                 <textarea asp-for="FinalRemark" class="form-control fw-bold text-dark" rows="4" placeholder="Enter final remark...">@Model.FinalRemark</textarea> *@
@*                 <span asp-validation-for="FinalRemark" class="text-danger"></span> *@
@*             </div> *@

@*             @if (!string.IsNullOrWhiteSpace(Model.FinalRemarkBy)) *@
@*             { *@
@*                 <div class="row"> *@
@*                     <div class="col-md-6"> *@
@*                     <label><strong>Final Remark By</strong></label> *@
@*                     <input type="text" class="form-control" value="@Model.FinalRemarkBy" readonly placeholder="Final remark by..." /> *@
@*                 </div> *@
@*                 </div> *@
@*             } *@





@*             <div class="text-center mt-3"> *@
@*                 <div class="dropdown d-inline"> *@
@*                     <button type="button" class="btn btn-outline-danger px-4 mx-5 dropdown-toggle" data-bs-toggle="dropdown" id="statusBtn"> *@
@*                         Select Status *@
@*                     </button> *@
@*                     <ul class="dropdown-menu"> *@

@*                         @if (Model.Status == "Viewed") *@
@*                         { *@
@*                             <li><a class="dropdown-item" href="#" onclick="changeStatus('Pending')">Pending</a></li> *@
@*                             <li><a class="dropdown-item" href="#" onclick="changeStatus('Hold')">Hold</a></li> *@
@*                             <li><a class="dropdown-item" href="#" onclick="changeStatus('Completed')">Completed</a></li> *@
@*                             <li><a class="dropdown-item" href="#" onclick="changeStatus('Cancelled')">Cancelled</a></li> *@
@*                         } *@
@*                         else if (Model.Status == "Pending") *@
@*                         { *@

@*                             <li><a class="dropdown-item" href="#" onclick="changeStatus('Pending')">Pending</a></li> *@
@*                             <li><a class="dropdown-item" href="#" onclick="changeStatus('Hold')">Hold</a></li> *@
@*                             <li><a class="dropdown-item" href="#" onclick="changeStatus('Completed')">Completed</a></li> *@
@*                             <li><a class="dropdown-item" href="#" onclick="changeStatus('Cancelled')">Cancelled</a></li> *@

@*                         } *@
@*                         else if (Model.Status == "Hold" || Model.Status == "On Hold") *@
@*                         { *@

@*                             <li><a class="dropdown-item" href="#" onclick="changeStatus('Hold')">Hold</a></li> *@
@*                             <li><a class="dropdown-item" href="#" onclick="changeStatus('Pending')">Pending</a></li> *@
@*                             <li><a class="dropdown-item" href="#" onclick="changeStatus('Completed')">Completed</a></li> *@
@*                             <li><a class="dropdown-item" href="#" onclick="changeStatus('Cancelled')">Cancelled</a></li> *@

@*                         } *@

@*                     </ul> *@
@*                 </div> *@

@*                 @* <button type="button" class="btn btn-outline-danger px-4 mx-5" onclick="markAsPending(@Model.ComplaintId)">Status</button> *@ 

@*                 <button type="submit" class="btn btn-primary px-4 mx-5" onclick="return submitForm();"> Save Complaint</button> *@



@*                 <a asp-controller="ComplaintRegistrations" asp-action="ServiceDashBoard1" class="btn btn-sm btn-outline-warning px-4 mx-3">Back To ServiceDashboard</a> *@
@*             </div> *@
@*         </form> *@

@*     </div> *@
@* </div> *@
@* <script> *@



@*              function changeStatus(status) { *@
@*         document.getElementById("statusBtn").innerText = status; // Update button text *@
@*         document.getElementById("selectedStatus").value = status; // Store selected status *@

@*          var remarkField = document.querySelector("textarea[name='Remark']"); *@
@*     var finalRemarkSection = document.getElementById("finalRemarkSection"); *@


@*      // ✅ Action change karo jo status select kiya uske hisaab se *@
@*             if (status === "Pending") { *@
@*                 document.getElementById("dynamicAction").value = "Pending"; *@
@*                 } else if (status === "Hold")  { *@
@*                 document.getElementById("dynamicAction").value = "Hold"; *@
@*             } else if (status === "On Hold")  { *@
@*                 document.getElementById("dynamicAction").value = "Hold"; *@
@*             }else if (status === "Completed")  { *@
@*                 document.getElementById("dynamicAction").value = "SaveRemark"; *@
@*             }else if (status === "Cancelled")  { *@
@*                 document.getElementById("dynamicAction").value = "Cancelled"; *@
@*             } *@
@*             else { *@
@*               document.getElementById("dynamicAction").value = "Viewed"; *@

@*             } *@


@*             if (remarkField.value.trim() !== "" && status !== "Completed" && status !== "Cancelled"  && status !== "Hold"  && status !== "Pending" ) { *@
@*         finalRemarkSection.style.display = "none"; *@
@*     }  *@
@*     } *@


@*               function submitForm() { *@

@*       var status = document.getElementById("selectedStatus").value.trim(); *@

@*               if (!status || status === "Viewed" ) { *@
@*         alert("Please select a status before submitting the form!"); *@
@*         return false; // ❌ Form submit nahi hoga *@
@*     } *@

@*         if (confirm("Are you sure you want to submit the form?")) { *@
@*             var action = document.getElementById("dynamicAction").value; *@
@*         var currentStatus = document.getElementById("selectedStatus").value; // ✅ Status ko fetch karo *@

@*              // ✅ Agar koi status select nahi kiya, toh default "currentStatus" rakhna *@
@*         if (!action || action === "SaveRemark") { *@
@*             action = currentStatus; *@
@*         } *@
@* document.getElementById("complaintForm").action = "/Service/" + action; *@



@*             return true; // ✅ Form submit hoga *@
@*         } *@
@*         return false; // ❌ Form submit nahi hoga agar "Cancel" dabaya *@
@*     } *@


@*     document.addEventListener("DOMContentLoaded", function () { *@
@*         var status = "@Model.Status".trim(); // Backend se status leke aayein *@
@*         var statusBtn = document.getElementById("statusBtn"); *@
@*         var statusInput = document.getElementById("selectedStatus"); *@
@*          var remarkField = document.querySelector("textarea[name='Remark']"); *@
@*              var finalRemarkField = document.querySelector("textarea[name='FinalRemark']"); *@
@*              var finalRemarkSection = document.getElementById("finalRemarkSection"); *@

@*         if (statusBtn) { *@

@*             statusInput.value = status; // Ensure hidden input has the same value *@
@*         } *@




@*          if (finalRemarkField && finalRemarkField.value.trim() !== "") { *@
@*         finalRemarkField.readOnly = true; *@
@*             remarkField.readOnly = true; *@

@*     } *@

@*                if ( *@
@*         remarkField.value.trim() !== "" && *@
@*         (status === "Completed" || status === "Cancelled") && *@
@*         finalRemarkField.value.trim() === "" *@
@*     ) { *@
@*         // ✅ Remark likha hua hai, Completed/Cancelled bhi hai, but FinalRemark empty hai → hide *@
@*         finalRemarkSection.style.display = "none"; *@
@*     } else if ( *@
@*         remarkField.value.trim() !== "" && *@
@*         finalRemarkField.value.trim() !== "" && *@
@*         (status === "Completed" || status === "Cancelled") *@
@*     ) { *@
@*         // ✅ Remark aur FinalRemark dono likha hua hai aur Completed/Cancelled hai → show *@
@*         finalRemarkSection.style.display = "block"; *@
@*         finalRemarkField.readOnly = true; *@
@*         } else if ( *@
@*         status !== "Completed" && *@
@*         status !== "Cancelled" && *@
@*         remarkField.value.trim() !== "" *@
@*     ) { *@
@*         // ✅ Hold ya Pending par ho + Remark likha ho tabhi FinalRemark dikhana hai *@
@*         finalRemarkSection.style.display = "block"; *@
@*     } *@


@*                  // ✅ Ye block fix kiya gaya hai: *@
@*         if ( *@
@*             finalRemarkField && remarkField && *@
@*             finalRemarkField.value.trim() !== "" && *@
@*             remarkField.value.trim() !== "" *@
@*         ) { *@
@*             document.getElementById("statusBtn").disabled = true; *@
@*             document.querySelector("button[type='submit']").disabled = true; *@


@*         } *@


@*     // ye niche k button hide karne k liye horaha ha use  *@
@*              if (status === "Completed" || status ==="Cancelled" || finalRemarkSection ==="") { *@
@*         document.getElementById("statusBtn").disabled = true; // Status button disable *@
@*         document.querySelector("textarea[name='Remark']").readOnly = true; // Remark field read-only *@
@*         document.querySelector("button[type='submit']").disabled = true; // Save Complaint button disable *@
@*         document.querySelectorAll(".dropdown-item").forEach(item => item.classList.add("disabled")); // Dropdown items disable *@
@*     } *@

@*         // ✅ Immediately set Remark field readonly after submit *@
@*                 if (remarkField && remarkField.value.trim() !== "") { *@
@*                     remarkField.readOnly = true; *@
@*                 } *@

@*     }); *@

@* </script> *@
@* <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script> *@

@model ServiceDashBoard1.Models.ServiceModel

@{
    var userRole = Context.Session.GetString("Role")?.Trim().ToLower();
    var isCoordinator = userRole == "coordinator";
}

<div class="container mt-4">
    <h2 class="text-center mb-4">Complaint Details</h2>

    
    
    <div class="card shadow p-4">
        <table class="table table-bordered">
            <tbody>
                <tr><th>Token:</th><td>@Model.TokenNumber</td></tr>
                <tr><th>Machine Serial No :</th><td>@Model.MachineSerialNo</td></tr>
                <tr><th>Company:</th><td>@Model.CompanyName</td></tr>
                <tr><th>Email:</th><td>@Model.Email</td></tr>
                <tr><th>Phone:</th><td>@Model.PhoneNo</td></tr>
                <tr><th>Address:</th><td>@Model.Address</td></tr>
                <tr><th>Contact Person:</th><td>@Model.ContactPerson</td></tr>
                <tr><th>Description:</th><td>@Model.ComplaintDescription</td></tr>
                <tr><th>Main Problem(s):</th><td><input type="text" class="form-control" value="@Model.MainProblemText" readonly /></td></tr>
                <tr><th>Sub Problem(s):</th><td><input type="text" class="form-control" value="@Model.SubProblemText" readonly /></td></tr>
                <tr><th>Current Status:</th><td><span class="badge bg-success text-white fw-bold fs-5 text-uppercase">@Model.Status</span></td></tr>
                <tr>
                    <th>Image:</th>
                    <td class="text-center">
                        @if (!string.IsNullOrEmpty(Model.ImageBase64))
                        {
                            <img src="data:image/png;base64,@Model.ImageBase64" alt="Complaint Image" class="img-thumbnail" style="max-width: 200px;" />
                        }
                        else
                        {
                            <span class="text-muted">No Image Available</span>
                        }
                    </td>
                </tr>
                @if (!isCoordinator && Model.Status == "Viewed")
            {
                <tr>
                    <th>Accepted</th>
                    <td>
                        <input type="checkbox" id="myCheckbox" name="myCheckbox" />
                        <label for="myCheckbox" style="font-size: 12px; color: #dc3545; margin-left: 8px;">
                            (Once accepted, this complaint cannot be edited)
                        </label>
                    </td>
                </tr>
            }
            </tbody>
        </table>
    </div>


    <div class="mt-4">
        @* <h3 class="fw-bold text-dark">Remark</h3> *@
        <form id="complaintForm" method="post">
            <input type="hidden" asp-for="ComplaintId" />
            <input type="hidden" id="selectedStatus" name="Status" value="@Model.Status" />
            <input type="hidden" id="dynamicAction" name="actionName" value="" />
            <!-- ✅ Add this line below -->
            <input type="hidden" name="FinalRemark" id="FinalRemarkHidden" />

            <!-- ✅ Show remark only if it contains data -->
            @if (!string.IsNullOrWhiteSpace(Model.Remark))
            {
                <div class="form-group mt-4">
                    <label><strong>Remark</strong></label>
                    <textarea class="form-control fw-bold text-dark" rows="4" readonly>@Model.Remark</textarea>
                </div>
            }

          
            <!-- Final Remark Field -->
            @if (!string.IsNullOrWhiteSpace(Model.FinalRemark))
            {
                <div class="form-group">
                    <label><strong>Final Remark</strong></label>
                    <textarea asp-for="FinalRemark" name="FinalRemark" class="form-control fw-bold text-dark" rows="4" readonly>@Model.FinalRemark</textarea>
                </div>
            }

            @if (!isCoordinator)
            {
            <div class="text-center mt-3">
                <div class="dropdown d-inline">
                    <button type="button" class="btn btn-outline-danger px-4 mx-5 dropdown-toggle" data-bs-toggle="dropdown" id="statusBtn">
                        Select Status
                    </button>
                    <ul class="dropdown-menu">
                        @if (Model.Status == "Accepted" || Model.Status == "Pending" || Model.Status == "Hold" || Model.Status == "On Hold")
                        {
                            <li><a class="dropdown-item" href="#" onclick="changeStatus('Pending')">Pending</a></li>
                            <li><a class="dropdown-item" href="#" onclick="changeStatus('Hold')">Hold</a></li>
                            <li><a class="dropdown-item" href="#" onclick="changeStatus('Completed')">Completed</a></li>
                            <li><a class="dropdown-item" href="#" onclick="changeStatus('Cancelled')">Cancelled</a></li>
                        }
                    </ul>
                </div>
                <button type="button" class="btn btn-primary px-4 mx-5" onclick="return submitForm()">Save Complaint</button>

                <a asp-controller="ComplaintRegistrations" asp-action="ServiceDashBoard1" class="btn btn-sm btn-outline-warning px-4 mx-3">Back To ServiceDashboard</a>
            </div>
   


<!-- Final Remark Modal -->
<div class="modal fade" id="finalRemarkModal" tabindex="-1" aria-labelledby="finalRemarkModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Enter Final Remark</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <textarea class="form-control" id="finalRemarkInput" rows="4" placeholder="Enter final remark..."></textarea>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="handleModalSubmit()">Submit</button>
            </div>
        </div>
    </div>
</div>

<!-- Remark Modal -->
<div class="modal fade" id="remarkModal" tabindex="-1" aria-labelledby="remarkModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Enter Remark</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <textarea class="form-control" id="remarkModalInput" rows="4" placeholder="Write your remark here..."></textarea>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="handleModalSubmit()">Save Remark</button>
            </div>
        </div>
    </div>
</div>
}

            @if (isCoordinator)
            {
                <div class="text-center mt-4">
                    <a asp-controller="ComplaintRegistrations" asp-action="Index" class="btn btn-primary px-4 fw-bold">
                      Back To AdminDashboard
                    </a>
                </div>
            }


        </form>
    </div>
</div>



    <script>
    document.addEventListener("DOMContentLoaded", function () {
        const checkbox = document.getElementById("myCheckbox");

        if (checkbox) {
            checkbox.addEventListener("change", function () {
                if (checkbox.checked) {
                    // Set status to Accepted
                    document.getElementById("statusBtn").innerText = "Accepted";
                    document.getElementById("selectedStatus").value = "Accepted";
                    document.getElementById("dynamicAction").value = "Accepted";
                } else {
                    // Optional: Reset if unchecked (can skip if not needed)
                    document.getElementById("statusBtn").innerText = "Select Status";
                    document.getElementById("selectedStatus").value = "@Model.Status";
                    document.getElementById("dynamicAction").value = "";
                }
            });
        }
    });



    function changeStatus(status) {
          
        document.getElementById("statusBtn").innerText = status;
        document.getElementById("selectedStatus").value = status;
        const actionMap = {
              
            "Pending": "Pending",
            "Hold": "Hold",
          
            "Completed": "SaveRemark",
            "Cancelled": "Cancelled",
               
        };
          
        document.getElementById("dynamicAction").value = actionMap[status] || "Viewed";
               console.log(document.getElementById("dynamicAction").value = actionMap[status] || "Viewed");
    }

    function submitForm() {
      
        const status = document.getElementById("selectedStatus").value.trim();
        // const remark = document.querySelector("textarea[name='Remark']").value.trim();
         const finalRemark = document.getElementById("finalRemarkInput").value.trim();

        const remarkField = document.querySelector("textarea[name='Remark']");
    const remark = remarkField ? remarkField.value.trim() : "";

    // const finalRemarkInput = document.getElementById("finalRemarkInput");
    // const finalRemark = finalRemarkInput ? finalRemarkInput.value.trim() : "";


        if ( status === "Viewed") {
            alert("Please select a valid status before submitting the form!");
            return false;
        }


    // ✅ Agar Completed/Cancelled aur finalRemark already hai, then submit directly
    if ((status === "Completed" || status === "Cancelled") && finalRemark !== "") {
        document.getElementById("FinalRemarkHidden").value = finalRemark;
        return confirmAndSubmit();
    }

            // ✅ New check added for Pending or Hold without remark
    // if ((status === "Pending" || status === "Hold") && remark === "") {
    //     alert("You have to write a remark.");

    //     return false;
    // }

       // 🔥 If Pending or Hold selected but remark empty, open modal
    if ((status === "Pending" || status === "Hold") && remark === "") {
        const modal = new bootstrap.Modal(document.getElementById("remarkModal"));
        modal.show();
        return false;
    }

        if ((status === "Completed" || status === "Cancelled")) {
            const modal = new bootstrap.Modal(document.getElementById("finalRemarkModal"));
            modal.show();

            return false;
        }

        return confirmAndSubmit();
    }





    function submitWithFinalRemark() {
        const finalRemark = document.getElementById("finalRemarkInput").value.trim();

        if (!finalRemark) {
            alert("Please enter a final remark.");
            return;
        }
                  
    document.getElementById("FinalRemarkHidden").value = finalRemark;

             const modal = bootstrap.Modal.getInstance(document.getElementById("finalRemarkModal"));
        modal.hide();
        confirmAndSubmit();
    }



    function confirmAndSubmit() {
        if (confirm("Are you sure you want to submit the form?")) {
            let action = document.getElementById("dynamicAction").value;
            const status = document.getElementById("selectedStatus").value;
            if (!action || action === "SaveRemark") {
                action = status;
            }
            document.getElementById("complaintForm").action = "/Service/" + action;
            document.getElementById("complaintForm").submit();
            return true;
        }
        return false;
    }

       document.addEventListener("DOMContentLoaded", function () {
            hideStatusBtnIfViewed(); // ✅ RIGHT PLACE to add this function bcoz dom call fristly when page load
        const finalRemarkField = document.querySelector("textarea[name='FinalRemark']");
        const remarkField = document.querySelector("textarea[name='Remark']");

        // ✅ Safe null check before accessing value
        if (finalRemarkField && finalRemarkField.value.trim() !== "") {
            finalRemarkField.classList.remove("d-none");
            finalRemarkField.readOnly = true;

            // Disable editing if Final Remark is already saved
            if (remarkField) remarkField.readOnly = true;

            const statusBtn = document.getElementById("statusBtn");
            if (statusBtn) statusBtn.disabled = true;

    const submitBtn = document.querySelector("button[onclick='return submitForm()']");
                if (submitBtn) submitBtn.disabled = true;

            document.querySelectorAll(".dropdown-item").forEach(item => item.classList.add("disabled"));
        }

    });

        


        function saveRemarkAndSubmit() {
      const remarkText = document.getElementById("remarkModalInput").value.trim();
   // Create or update hidden remark textarea
        let remarkField = document.querySelector("textarea[name='Remark']");

        if (!remarkField) {
            remarkField = document.createElement("textarea");
            remarkField.name = "Remark";
            remarkField.style.display = "none";
            document.getElementById("complaintForm").appendChild(remarkField);
        }
         remarkField.value = remarkText;

        // Hide modal and submit
        const modal = bootstrap.Modal.getInstance(document.getElementById("remarkModal"));
        modal.hide();
        confirmAndSubmit();
    }



        function handleModalSubmit() {

        const status = document.getElementById("selectedStatus").value.trim();

        if (status === "Pending" || status === "Hold") {
            saveRemarkAndSubmit();
        } else if (status === "Completed" || status === "Cancelled") {
            submitWithFinalRemark();
        } else {
            alert("Something went wrong. Please try again.");
        }
    }


        function hideStatusBtnIfViewed() {
        const currentStatus = document.getElementById("selectedStatus").value.trim();
        const statusBtn = document.getElementById("statusBtn");

        if (currentStatus === "Viewed" && statusBtn) {
            statusBtn.style.display = "none";
        }
    }
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
