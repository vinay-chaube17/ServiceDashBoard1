@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}
@model ServiceDashBoard1.Models.User

<!DOCTYPE html>
<html lang="en">
<head>
   
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">

    
@section PageStyles {
    <style>
        body {
            background-image: url('/images/laser-cutting-of-metal-sheets.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            min-height: 100vh;
        }
    </style>
}
</head>
<body>
    <div >
        @Html.ActionLink("Back to AdminDashBoard", "Index", "ComplaintRegistrations", null, new { @class = "btn btn-primary" })

    </div>
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-6">
                <div class="card mt-5">
                    <div class="card-header text-center">
                        <h3>Register</h3>
                    </div>
                    <div class="card-body">
                        <form method="post">

                            <div class="mb-3">
                                <label for="Name" class="form-label">Name</label>
                                <input type="text" class="form-control" id="Name" name="Name" value="@Model?.Name" />
                                <span asp-validation-for="Name" class="text-danger"></span>

                            </div>
                            <div class="mb-3">
                                <label for="EmailId" class="form-label">Email</label>
                                <input type="email" class="form-control" id="EmailId" name="EmailId" value="@Model?.EmailId" />
                                <span asp-validation-for="EmailId" class="text-danger"></span> <!-- ✅ Model Validation -->
                                <span id="EmailIdError" class="text-danger" style="display:none;"></span> <!-- ✅ AJAX Error -->
                            </div>


                            <div class="mb-3">
                                <label for="PhoneNo" class="form-label">Phone Number</label>
                                <input type="tel" class="form-control" id="PhoneNo" name="PhoneNo" value="@Model?.PhoneNo" />
                                <span asp-validation-for="PhoneNo" class="text-danger"></span> <!-- ✅ Model Validation -->

                                <span id="PhoneNoError" class="text-danger" style="display:none;"></span> <!-- ✅ AJAX Error -->
                            </div>

                            <div class="mb-3">
                                <label for="Address" class="form-label">Address</label>
                                <input type="text" class="form-control" id="Address" name="Address" value="@Model?.Address" />

                                <span asp-validation-for="Address" class="text-danger"></span>
                            </div>

                            <div class="mb-3">
                                <label for="Username" class="form-label">Username</label>
                                <input type="text" class="form-control" id="Username" name="Username" value="@Model?.Username" />
                                <span asp-validation-for="Username" class="text-danger"></span> <!-- ✅ Model Validation -->
                                <span id="UsernameError" class="text-danger" style="display:none;"></span> <!-- ✅ AJAX Error -->
                            </div>


                            <div class="mb-3">
                                <label for="Password" class="form-label">Password</label>
                                <input type="password" class="form-control" id="Password" name="Password" />
                                <span asp-validation-for="Password" class="text-danger"></span>

                            </div>

                            <div class="mb-3">
                                <label for="Role" class="form-label">AssignTo</label>
                                <select class="form-control" id="Role" name="Role">
                                    <option value="Coordinator">Coordinator</option>
                                    <option value="Sparepart">Sparepart</option>
                                    <option value="Service Engineer">Service Engineer</option>
                                    <option value="Field Engineer">Field Engineer</option>
                                </select>
                            </div>



                            <button type="submit" class="btn btn-primary w-100">Register</button>

                            
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

<script>

  

    $(document).ready(function () {
        $("#EmailId, #PhoneNo,#Address,#Password,#Name,#Username").on("input", function () {
            var field = $(this).attr("id");

            // **Model Validation Error ko hide karna**
            $("span[data-valmsg-for='" + field + "']").text(""); // ✅ Model error hide

            // **AJAX Error ko bhi hatana agar user field change kare**
            $("#" + field + "Error").text("").hide();
        });


          


        // ✅ Phone Number Ke Liye Real-Time Validation Add Karo
            $("#PhoneNo").on("input", function () {
        var value = $(this).val().trim();
        var errorSpan = $("#PhoneNoError");

        // ✅ Leading 0 Remove Karo
        value = value.replace(/^0+/, '');
        $(this).val(value); // ✅ Input Field Update

        // ✅ Real-Time 10-Digit Check
        if (!/^\d{10}$/.test(value)) {
            errorSpan.text("Phone number must be exactly 10 digits").css("color", "red").show();
        } else {
            errorSpan.text("").hide();
        }
    });


        $("#EmailId, #PhoneNo, #Username").on("blur", function () {
            var field = $(this).attr("id");
            var value = $(this).val().trim();
            var errorSpan = $("#" + field + "Error"); // ✅ AJAX Error Span

            // Agar field empty hai, toh AJAX validation mat karo (sirf Model validation chale)
            if (value === "") {
                errorSpan.text("").hide();
                return;
            }

            // AJAX Call to Check Existing User
            $.post("/Users/CheckExistingUser", { field: field, value: value }, function (data) {
                if (data.exists) {
                    errorSpan.text(field + " already exists! Please choose another.").css("color", "red").show();
                } else {
                    errorSpan.text("").hide();
                }
            }).fail(function () {
                errorSpan.text("Error checking " + field).css("color", "red").show();
            });
        });
    });
</script>


